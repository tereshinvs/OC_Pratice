classdef X0Class
	properties
		alpha1, alpha2;
	end
	
	methods
		function obj = X0Class(talpha1, talpha2)
			obj.alpha1 = talpha1;
			obj.alpha2 = talpha2;
		end
		
		function [value, x_star] = support_function(obj, x)
			global EPS;
			
			%if abs(x(1)) < 1e-1 %EPS.ZERO_IN_IMAG_TESTING
			%	x
			%	x_star = [obj.alpha1; obj.alpha2 + sign(x(2))]
			%	value = x_star.' * x
			%	return;
			%end
			%if abs(x(2)) < 1e-1 %EPS.ZERO_IN_IMAG_TESTING
			%	x
			%	x_star = [obj.alpha1 + sign(x(1)); obj.alpha2]
			%	value = x_star.' * x
			%	return;
			%end

			%			xs = [ ...
%				((4*obj.alpha1*x(2))*x(1)^5 + (-(144*x(1)^4*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(2/3) + x(2)^4 + 12*x(1)^2*x(2)^2*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(1/3))/(36*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(1/3)))^(3/2))/((4*x(2))*x(1)^5)
%				((4*obj.alpha1*x(2))*x(1)^5 - (-(144*x(1)^4*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(2/3) + x(2)^4 + 12*x(1)^2*x(2)^2*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(1/3))/(36*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(1/3)))^(3/2))/((4*x(2))*x(1)^5)
%				((4*obj.alpha1*x(2))*x(1)^5 + ((144*x(1)^4*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(2/3) + 3^(1/2)*x(2)^4*i + x(2)^4 - 24*x(1)^2*x(2)^2*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(1/3) - 3^(1/2)*x(1)^4*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(2/3)*144*i)/(72*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(1/3)))^(3/2))/((4*x(2))*x(1)^5)
%				((4*obj.alpha1*x(2))*x(1)^5 + ((144*x(1)^4*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(2/3) - 3^(1/2)*x(2)^4*i + x(2)^4 - 24*x(1)^2*x(2)^2*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(1/3) + 3^(1/2)*x(1)^4*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(2/3)*144*i)/(72*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(1/3)))^(3/2))/((4*x(2))*x(1)^5)
%				((4*obj.alpha1*x(2))*x(1)^5 - ((144*x(1)^4*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(2/3) - 3^(1/2)*x(2)^4*i + x(2)^4 - 24*x(1)^2*x(2)^2*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(1/3) + 3^(1/2)*x(1)^4*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(2/3)*144*i)/(72*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(1/3)))^(3/2))/((4*x(2))*x(1)^5)
%				((4*obj.alpha1*x(2))*x(1)^5 - ((144*x(1)^4*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(2/3) + 3^(1/2)*x(2)^4*i + x(2)^4 - 24*x(1)^2*x(2)^2*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(1/3) - 3^(1/2)*x(1)^4*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(2/3)*144*i)/(72*((1728*x(1)^6*((108*x(1)^4*x(2)^4 - x(2)^8)/(6912*x(1)^8))^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/(1728*x(1)^6))^(1/3)))^(3/2))/((4*x(2))*x(1)^5)
 % 			];
%			ys = [...
%				obj.alpha2 + (- (x(1)^2*x(2)^2)/3 - 4*x(1)^4*(x(2)^6/(1728*x(1)^6) - x(2)^2/(8*x(1)^2) + (x(2)^4/(64*x(1)^4) - x(2)^8/(6912*x(1)^8))^(1/2))^(1/3) - x(2)^4/(36*(x(2)^6/(1728*x(1)^6) - x(2)^2/(8*x(1)^2) + (x(2)^4/(64*x(1)^4) - x(2)^8/(6912*x(1)^8))^(1/2))^(1/3)))^(1/2)/(2*x(1)^2)
%				obj.alpha2 - (- (x(1)^2*x(2)^2)/3 - 4*x(1)^4*(x(2)^6/(1728*x(1)^6) - x(2)^2/(8*x(1)^2) + (x(2)^4/(64*x(1)^4) - x(2)^8/(6912*x(1)^8))^(1/2))^(1/3) - x(2)^4/(36*(x(2)^6/(1728*x(1)^6) - x(2)^2/(8*x(1)^2) + (x(2)^4/(64*x(1)^4) - x(2)^8/(6912*x(1)^8))^(1/2))^(1/3)))^(1/2)/(2*x(1)^2)
%				obj.alpha2 + (-(6*(x(1)^2*((12*x(1)^6*((3*x(2)^4*(108*x(1)^4 - x(2)^4))/x(1)^8)^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/x(1)^6)^(1/3) - x(2)^2)*(x(2)^2 + 3^(1/2)*x(2)^2*i - x(1)^2*((12*x(1)^6*((3*x(2)^4*(108*x(1)^4 - x(2)^4))/x(1)^8)^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/x(1)^6)^(1/3) + 3^(1/2)*x(1)^2*((12*x(1)^6*((3*x(2)^4*(108*x(1)^4 - x(2)^4))/x(1)^8)^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/x(1)^6)^(1/3)*i))/((12*x(1)^6*((3*x(2)^4*(108*x(1)^4 - x(2)^4))/x(1)^8)^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/x(1)^6)^(1/3))^(1/2)/(12*x(1)^2)
%				obj.alpha2 + ((6*(x(1)^2*((12*x(1)^6*((3*x(2)^4*(108*x(1)^4 - x(2)^4))/x(1)^8)^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/x(1)^6)^(1/3) - x(2)^2)*(x(1)^2*((12*x(1)^6*((3*x(2)^4*(108*x(1)^4 - x(2)^4))/x(1)^8)^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/x(1)^6)^(1/3) + 3^(1/2)*x(2)^2*i - x(2)^2 + 3^(1/2)*x(1)^2*((12*x(1)^6*((3*x(2)^4*(108*x(1)^4 - x(2)^4))/x(1)^8)^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/x(1)^6)^(1/3)*i))/((12*x(1)^6*((3*x(2)^4*(108*x(1)^4 - x(2)^4))/x(1)^8)^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/x(1)^6)^(1/3))^(1/2)/(12*x(1)^2)
%				obj.alpha2 - ((6*(x(1)^2*((12*x(1)^6*((3*x(2)^4*(108*x(1)^4 - x(2)^4))/x(1)^8)^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/x(1)^6)^(1/3) - x(2)^2)*(x(1)^2*((12*x(1)^6*((3*x(2)^4*(108*x(1)^4 - x(2)^4))/x(1)^8)^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/x(1)^6)^(1/3) + 3^(1/2)*x(2)^2*i - x(2)^2 + 3^(1/2)*x(1)^2*((12*x(1)^6*((3*x(2)^4*(108*x(1)^4 - x(2)^4))/x(1)^8)^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/x(1)^6)^(1/3)*i))/((12*x(1)^6*((3*x(2)^4*(108*x(1)^4 - x(2)^4))/x(1)^8)^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/x(1)^6)^(1/3))^(1/2)/(12*x(1)^2)
%				obj.alpha2 - (-(6*(x(1)^2*((12*x(1)^6*((3*x(2)^4*(108*x(1)^4 - x(2)^4))/x(1)^8)^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/x(1)^6)^(1/3) - x(2)^2)*(x(2)^2 + 3^(1/2)*x(2)^2*i - x(1)^2*((12*x(1)^6*((3*x(2)^4*(108*x(1)^4 - x(2)^4))/x(1)^8)^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/x(1)^6)^(1/3) + 3^(1/2)*x(1)^2*((12*x(1)^6*((3*x(2)^4*(108*x(1)^4 - x(2)^4))/x(1)^8)^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/x(1)^6)^(1/3)*i))/((12*x(1)^6*((3*x(2)^4*(108*x(1)^4 - x(2)^4))/x(1)^8)^(1/2) - 216*x(1)^4*x(2)^2 + x(2)^6)/x(1)^6)^(1/3))^(1/2)/(12*x(1)^2)
%			];
%		
%			x0 = [];
%			y0 = [];
%			for j = 1 : size(xs, 1)
%				if abs(imag(xs(j))) < EPS.ZERO_IN_IMAG_TESTING && abs(imag(ys(j))) < EPS.ZERO_IN_IMAG_TESTING
%					x0 = [x0; real(xs(j))];
%				end
%			end
%			x0 = x0
%			y0 = y0
%			
%			vals = x0 .* x(1) + y0 .* x(2);
%			[value, j] = max(vals);
%			x_star = [x0(j); y0(j)];

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%			[res, fval] = fsolve(@(tx) ...
%				[ ...
%					x(1) + 2 * tx(3) * (tx(1) - obj.alpha1); ...
%					x(2) + 4 * tx(3) * (tx(2) - obj.alpha2)^3; ...
%					(tx(1) - obj.alpha1)^2 + (tx(2) -obj.alpha2)^4 - 1 ...
%				], [obj.alpha1; obj.alpha2; 10]);
%			res = res
%			fval = fval


			res = fzero(@(tl) ((2*obj.alpha1*tl - x(1))/(2*tl) - obj.alpha1)^2 + (nthroot(-x(2)/(4*tl), 3))^4 - 1, [1]);
			tx = (2 * obj.alpha1 * res - x(1)) / (2 * res);
			ty = nthroot(-x(2) / (4 * res), 3) + obj.alpha2;
			x0 = [tx; 2*obj.alpha1-tx];
			y0 = [ty; 2*obj.alpha2-ty];
			vals = x0 .* x(1) + y0 .* x(2);
			[value, i] = max(vals);
			x_star = [x0(i); y0(i)];

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%			lambdas = [ ...
%				((x(1)^4/16 + x(2)^4/4)^(1/2)/2 + x(1)^2/8)^(1/2); ...
%				(x(1)^2/8 - (x(1)^4/16 + x(2)^4/4)^(1/2)/2)^(1/2); ...
%				-((x(1)^4/16 + x(2)^4/4)^(1/2)/2 + x(1)^2/8)^(1/2); ...
%				-(x(1)^2/8 - (x(1)^4/16 + x(2)^4/4)^(1/2)/2)^(1/2); ...
%			];

%			eps = EPS.ZERO_IN_IMAG_TESTING;
%			lambdas = real(lambdas(abs(imag(lambdas)) < eps));
%			lambdas = lambdas(abs(lambdas) > eps);
		
%			x0 = -(x(1) - 2 * obj.alpha1 * lambdas) ./ (2 * lambdas);
%			y0 = -(x(2) - 2 * obj.alpha2 * lambdas) ./ (2 * lambdas);
%			vals = x0 .* x(1) + y0 .* x(2);
%			[value, i] = max(vals);
%			x_star = [x0(i); y0(i)];
		end
		
		function [x, y] = get_border(obj, STEP)
			global EPS;
			eps = EPS.ZERO_IN_IMAG_TESTING;
			phi = 0.0 : STEP : (2.0 * pi);

			x = zeros(size(phi, 2), 1);
			y = zeros(size(phi, 2), 1);

			for i = 1 : size(phi, 2)
				if abs(phi(i)) < eps || abs(phi(i) - 2.0 * pi) < eps
					x(i) = obj.alpha1 + 1.0;
					y(i) = obj.alpha2;
				elseif abs(phi(i) - pi) < eps
					x(i) = obj.alpha1 - 1.0;
					y(i) = obj.alpha2;
				else
					sin_phi = sin(phi(i));
					cos_phi = cos(phi(i));
					pho = sqrt((-cos_phi^2 + sqrt(cos_phi^4 + 4.0 * sin_phi^4)) / (2.0 * sin_phi^4));
					x(i) = obj.alpha1 + pho * cos_phi;
					y(i) = obj.alpha2 + pho * sin_phi;
				end
			end
		end
		
		function res = is_inside(obj, x)
			global EPS;
			res = (x(1) - obj.alpha1)^2 + (x(2) - obj.alpha2)^4 <= 1 + EPS.TOUCHING_X1;
		end
	end
end
